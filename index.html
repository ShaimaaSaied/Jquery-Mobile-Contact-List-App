<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
</head>

<body>
    <section data-role="page" id="contactList" data-transition="flip" data-add-back-btn="true">
        <header data-role="header">
            <a href="#newContactPage" data-icon="plus">Add</a>
            <h1> Contact List</h1>
        </header>
        <article data-role="content">
            <form class="ui-filterable">
                <input id="filterBasic-input" data-type="search">
            </form>
            <ul data-filter="true" data-filter-placeholder="Search ..." data-input="#filterBasic-input" data-inset="true" data-role="listview" id="myList">

                </ul>
            </article>
            <footer data-role="footer">
                <h1>Contact List</h1>
            </footer>
        </section>

        <section data-role="page" id="newContactPage"  data-transition="flip" data-add-back-btn="true">
            <header data-role="header">
                <a href="#contactList" data-icon="carat-l">Back</a>
                <h1> New Contact</h1>
            </header>
            <article data-role="content">
                <form onsubmit="">
                    <label>Name </label><input type="text" id="name" pattern="^[a-zA-Z\s]*$" required><br>
                    <label>Phone</label><input type="text" id="phone" pattern="(01)[0-9]{9}" required><br>
                    <label>Email</label><input type="email" id="email" required><br><br>
                    <label for="gender">Gender:</label>
                    <select data-role="slider" id="gender" name="flip">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                    <br><br>
                    <a href="#contactList" class="ui-btn ui-btn-inline ui-icon-check ui-btn-icon-left"
                       onclick="saveContact()">Save</a>
                    <a href="#contactList" class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-left">Cancel</a>
                </form>
            </article>
            <footer data-role="footer">
                <h1> Contact List</h1>
            </footer>
        </section>

        <section data-role="page" id="contactProfile" data-add-back-btn="true">
            <header data-role="header">
                <a href="#contactList" data-icon="carat-l">Back</a>
                <h1 id="contactName"> </h1>
            </header>
            <article data-role="content">
                <form onsubmit="">
                    <div id="conData">
                        <img alt="profile picture" height="100px" id="profileImg" src="female.png" width="100px">
                        <a class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-left" data-transition="pop"
                           href="#dialog" id="deleteBtn"></a>
                        <a class="ui-btn ui-btn-inline ui-icon-edit ui-btn-icon-left" href="#newContactPage"
                           onclick="editContact()"></a>
                        <a class="ui-btn ui-btn-inline ui-icon-phone ui-btn-icon-left" href="#"></a>
                    </div>

                </form>
            </article>
            <footer data-role="footer">
                <h1> Contact List</h1>
            </footer>
        </section>

        <section id="dialog" data-role="dialog" >
            <article data-role="content">
                <p>Delete Contact?</p><br>
            </article>
            <article id="buttons" data-role="content">
                <a href="#contactList" class="ui-btn ui-btn-inline" onclick="deleteContact(this.id)">Delete</a>
                <a class="ui-btn ui-btn-inline" data-transition="flip" >Delete</a>
            </article>
        </section>

        <script>
            // $("#contactList").ready(loadContactList());
            // var contactArray = new Array();
            var CurrentProfileContact;
            function Contact(name, phone, email, gender,id) {
                this.name = name;
                this.phone = phone;
                this.email = email;
                this.gender = gender;
                this.id=id;
            }

        function createListItem(contact) {
            var li = document.createElement("LI");
            li.setAttribute("id", contact.id);
            var div = document.createElement("DIV");
            div.setAttribute("id", "div");
            div.setAttribute("data-transition", "flip");
            var contactName = document.createElement("A");
            contactName.setAttribute("id", contact.id + "Name");
            contactName.setAttribute("href", "#contactProfile");
            contactName.setAttribute("onclick", "CurrentProfileContact=contact; setProfile();");

            contactName.innerText = contact.name;
            var callBtn = document.createElement("BUTTON");
            callBtn.setAttribute("id", contact.id + "callBtn");
            callBtn.setAttribute("class", "ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-phone");
            callBtn.setAttribute("href", "tel:" + contact.phone);
            callBtn.style.width = "30px";
            callBtn.style.height = "50px";
            var imgBtn = document.createElement("IMG");
            imgBtn.setAttribute("id", contact.id + "imgBtn");
            imgBtn.style.width = "100px";
            imgBtn.style.height = "100px";
            if (contact.gender == "Female") {
                imgBtn.setAttribute("src", "female.png");
            } else {
                imgBtn.setAttribute("src", "male.png");
            }
            div.appendChild(imgBtn);
            div.appendChild(contactName);
            div.appendChild(callBtn);

            li.appendChild(div);
            var ul = document.getElementById("myList");
            ul.appendChild(li);
        }
            function saveContact() {
                var name = $("#name").val();
                var phone = $("#phone").val();
                var email = $("#email").val();
                var gender = $("#flip").val();
                var date = new Date();
                date.setTime(date.getTime());
                if (!isSaved) {
                    var contact = new Contact(name, phone, email, gender, date.toUTCString());
                    createListItem(contact);
                } else {
                    document.getElementById(CurrentProfileContact.id + "Name").value = name;
                }
            }

        function deleteContact() {
            $("#" + CurrentProfileContact.id).remove();
            history.back();
            CurrentProfileContact = undefined;
        }

        function setProfile() {
            $('#contactName').val(CurrentProfileContact.name);
            if (CurrentProfileContact.gender == 'Female')
                $('#profilePicture').src = 'female.png';
            else
                $('#profilePicture').src = 'male.png';
        }



        /////////////////////////////////////////////////////////////////////////////////alaaa

            var isSaved = false;

            function editContact() {
                document.getElementById("name").value = CurrentProfileContact.name;
                document.getElementById("phone").value = CurrentProfileContact.phone;
                document.getElementById("email").value = CurrentProfileContact.email;
                document.getElementById("gender").value = CurrentProfileContact.gender;
                isSaved = true;
            }

        </script>

</body>

</html>
